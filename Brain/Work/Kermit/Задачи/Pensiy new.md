

**Todo**
Добавить поиск по ИНН(ЮРЛИЦА)

ОГРН - при поиске по огрн выдать список сотрудников


При поиске или мерже так же как и в старом

Нужно возвращать флаг если человек умер;

**Получение родственников**
Получаем 2 родстенников в бд родстенников:
*МАЛЬЦЕВ ЮРИЙ ИВАНОВИЧ 20.05.1951*
*МАЛЬЦЕВА НАТАЛЬЯ ЮРЬЕВНА 22.07.1977*
Ищем соответствия в табл пенс фонда:




**Таблицы:**

- spu_acc_dead_inf - 48 705 269
- spu_work_rec - истории о записях работы и должностях == **369 070 832**
- spu_work_rec -- инфо о работе, нужно правильно расшифровывать и засунуть в маассив анкеты
- spu_prsn_another_name - Тут встречается такое что фамилии не меняются

**Связи**
- Паспорт джоинится с юзером по prsn_id
- Адрес джоинится с юзером по prsn_id
- Родственники связаны по **spu_prsn.prsn_id** = **spu_prsn_rel.acc_id**
--- 

**Нюансы**
- Адресов может быть несколько, максимум 14
- Паспортов может быть несколько, максимум 2
- Не ясно что делать для компаний у которых много сотрудников, например Магнит (инн 2310031475)

Выделить осн таблицу если их несколько то сделать логику кода




1. Сделать запросы для деталок человека и организации

Для человека получить: его инфо, умер или нет, места роботы, 


**Модификации**

**Добавление индексов**
create index spu_org__kpp on spu_org(kpp);
create index spu_org__ogrn on spu_org(ogrn);
create index spu_sal_fl__acc_inn on spu_sal_fl(acc_inn);
create index spu_prsn__acc_id on spu_prsn(acc_id);

Добавление таблицы **okz_codes**

```
create table okz_codes  
(  
    code integer,  
    name text  
);  
  
create index okz_codes__code  
    on okz_codes (code);
```

Данные для таблицы **okz_codes**:
![[okz_codes.csv]]

