
**Задача**
Оптимзиировать скорость поиска по базе и качество данных в результатах

## **Проблема**
Большое время выполнения запроса получение нескольких анкет если их больше 30

## **DOD**
Получение деталки стало работать заметно быстрее
Для каждой машины подтягивается полная информация
Для одной машины есть одна строка в таблице с информацией

## Среда выполнения
Сторонний сервер на Linux

## Методы реализации
### Формирование только таблицы с информацией о машине
**Цель**
Получить на выходе одну таблицу с данными об авто и ее статической информации, такие как марка, модель, вин
Для одной машины должна быть одна строка

**Нюансы**
- У машин может не быть вин номера
- Может быть несколько записей по одному вин номеру, нужно понять из какой строки использовать данные
- Номера у машин могут быть с окончанием RUS и без

**Алгоритм**
1. Посчитать сколько всего машин с уникальным вином, номером машины, и у которых нет ни того ни другого (мусор)
2. Получить все уникальные вин номера в csv файле
3. Скрипт на питоне который будет проходить по каждой машине, получать статическую инфу из бд и сохранять в csv файл. 
4. Пройтись этим же скриптом но только по номерам машин, тоесть тем машинам у которых нет вин номера, можно например по спектру пройтись по ним
5. Залить данные из файла в бд
6. Изменить код получения информации о машине чтобы он использовал данные из этой таблицы (Или джоином или отдельным запросом)
7. Проверить скорость роботы запросов на прод бд и анкетах которые


### Нормализация всей бд
**Цель** 
Получить на выходе несколько таблиц, например юзеры, машины, водители, собственники

**Сложность** 
Нужно правильно построить связи, также проблема в том что для одной машины обычно несколько записей


**Этапы**
- [ ] Получить количество уникальных вин номеров и номеров в таблиц
- [ ] В коде проверить какие запросы тормозят, сохранить их
Тормозит **getAllOwnersByVin** - 17 секунд тоесть нужно оптимизировать его

- [ ] Получить уникальные вин номера и номера машин из Новой версии автобазы
```
select vehicle_rec_id, vin, license_plate from vehicle;
```
- [x] Расмотреть вариант чтобы брать данные из спектра -- Вариант такой себе потому что нет марки в нем
- [ ] Сделать 


**Что нужно сделать**:
- [ ] Сформировать таблицу соответствий для овнеров и драйверов. В ней должны быть ссылки на авто и юзера

Привет
Хочу сделать таблицу с данными про авто чтобы оптимизировать поиск. Нужен доступ к обновленной версии автобазы, нужно для скрипта вытащить уникальные вин номера чтобы потом для каждой получить информации о машине



## Тест кейсы



[[Avtoins]]